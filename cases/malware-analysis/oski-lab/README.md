# CyberDefenders Case Walkthrough: Bir Bilgi HÄ±rsÄ±zÄ±nÄ±n Anatomisi (Stealc)

Merhaba siber gÃ¼venlik meraklÄ±larÄ±! Bu yazÄ±da, CyberDefenders platformunda yer alan "easy" seviyesindeki bir vakanÄ±n analizini adÄ±m adÄ±m gerÃ§ekleÅŸtireceÄŸiz. Bu vaka, bize tek bir delilden (bir MD5 hash'i) yola Ã§Ä±karak bir zararlÄ± yazÄ±lÄ±mÄ±n tÃ¼m yaÅŸam dÃ¶ngÃ¼sÃ¼nÃ¼ nasÄ±l ortaya Ã§Ä±karabileceÄŸimizi gÃ¶steren mÃ¼kemmel bir Ã¶rnektir. Analizimizde VirusTotal ve Any.run gibi paha biÃ§ilmez online araÃ§larÄ± nasÄ±l etkin bir ÅŸekilde kullanacaÄŸÄ±mÄ±zÄ± gÃ¶receÄŸiz.

HazÄ±rsanÄ±z, dedektif ÅŸapkalarÄ±mÄ±zÄ± takalÄ±m ve baÅŸlayalÄ±m!

## Olay Yeri: Ä°lk Delilimiz

Vaka, bize tek bir **Indicator of Compromise (IOC)** ile baÅŸlÄ±yor:

- **MD5 Hash:** `12c1842c3ccafe7408c23ebf292ee3d9`

Bir analist olarak ilk adÄ±mÄ±mÄ±z, bu dijital parmak izini kullanarak dosya hakkÄ±nda hÄ±zlÄ±ca bilgi toplamaktÄ±r. Bunun iÃ§in ilk duraÄŸÄ±mÄ±z genellikle VirusTotal'dÄ±r. VirusTotal, dosyanÄ±n `exploit`, `cve-2016-0101` ve `malware` gibi etiketlere sahip olduÄŸunu bize hÄ±zlÄ±ca sÃ¶yler. Ancak bu vakanÄ±n kalbi, zararlÄ±nÄ±n davranÄ±ÅŸlarÄ±nÄ± canlÄ± olarak izleyebileceÄŸimiz Any.run platformunda yatÄ±yor.

---

## Soru 1: Malware OluÅŸturulma ZamanÄ±

> **Soru:** Determining the creation time of the malware can provide insights into its origin. What was the time of malware creation?

### Analitik YaklaÅŸÄ±m

Bir zararlÄ± yazÄ±lÄ±mÄ±n oluÅŸturulma zamanÄ±nÄ± bulmak iÃ§in, Ã¶nce bize verilen hash dosyasÄ±nÄ± kullanarak dosyayÄ± tehdit istihbarat platformlarÄ±nda analiz etmemiz gerekir. Bu vaka iÃ§in `hash.txt` dosyasÄ±nda MD5 hash'i bulunuyor ve bu hash'i VirusTotal gibi platformlarda kullanarak dosya hakkÄ±nda detaylÄ± bilgi elde edebiliriz.

### KanÄ±tlarÄ± Ä°nceleme

Ä°lk olarak, bize verilen `hash.txt` dosyasÄ±nÄ± inceleyelim:

![Hash.txt dosyasÄ± iÃ§eriÄŸi](assets/q1-1.png)

Bu dosyada `MD5 Hash: 12c1842c3ccafe7408c23ebf292ee3d9` deÄŸeri bulunuyor ve dosya bize bu hash'i Ã§evrimiÃ§i tehdit istihbarat platformlarÄ±nda kullanmamÄ±z gerektiÄŸini belirtiyor.

ArdÄ±ndan, bu MD5 hash'i VirusTotal'da arayarak dosya hakkÄ±nda detaylÄ± bilgi elde ediyoruz:

![VirusTotal analiz sonuÃ§larÄ±](/assets/q1-2.png)

VirusTotal analizinde, dosyanÄ±n **"Creation Time"** deÄŸeri `2022-09-28 17:40:46 UTC` olarak gÃ¶rÃ¼lmektedir. Bu, zararlÄ± yazÄ±lÄ±mÄ±n oluÅŸturulma zamanÄ±dÄ±r.

**âœ… Cevap:** `2022-09-28 17:40:46 UTC`

---

## Soru 2: Komuta & Kontrol (C2) Sunucusu

> **Soru:** Identifying the command and control (C2) server that the malware communicates with can help trace back to the attacker. Which C2 server does the malware in the PPT file communicate with?

### Analitik YaklaÅŸÄ±m

Bir zararlÄ± yazÄ±lÄ±mÄ±n C2 sunucusunu bulmak iÃ§in, VirusTotal analizinde BEHAVIOR bÃ¶lÃ¼mÃ¼ne odaklanmamÄ±z gerekir. Bu bÃ¶lÃ¼m, zararlÄ±nÄ±n bellekte tuttuÄŸu URL'leri ve aÄŸ iletiÅŸim desenlerini gÃ¶sterir. C2 sunucusu genellikle POST istekleri yapÄ±lan dinamik endpoint'ler olarak tespit edilir.

### KanÄ±tlarÄ± Ä°nceleme

VirusTotal analizinde, BEHAVIOR bÃ¶lÃ¼mÃ¼ altÄ±nda **Memory Pattern Urls** kÄ±smÄ±nÄ± inceleyerek C2 sunucusunu tespit ediyoruz:

![Memory Pattern Urls ve C2 sunucusu](assets/memory-pattern-urls-c2.png)

GÃ¶rselde, **Memory Pattern Urls** bÃ¶lÃ¼mÃ¼nde listelenen URL'leri incelediÄŸimizde:
- `http://171.22.28.221/5c06c05b7b34e8e6.php`: Bu URL, bir `.php` uzantÄ±lÄ± betiÄŸe iÅŸaret ediyor. Bu, sunucu tarafÄ±nda dinamik iÅŸlemler (veri alma, komut gÃ¶nderme) yapÄ±ldÄ±ÄŸÄ±nÄ±n en gÃ¼Ã§lÃ¼ gÃ¶stergesidir. Bu, tipik bir C2 iletiÅŸim kanalÄ±dÄ±r.
- DiÄŸer URL'ler ya sadece IP adresini (`171.22.28.221`) ya da indirilen dosyalarÄ± gÃ¶steriyor. Bunlar iletiÅŸim kanalÄ±nÄ±n kendisi deÄŸil, hedefin adresi veya indirilen araÃ§lardÄ±r.

Bu nedenle, zararlÄ± yazÄ±lÄ±mÄ±n iletiÅŸim kurduÄŸu C2 sunucusu bu `.php` adresidir.

**âœ… Cevap:** `http://171.22.28.221/5c06c05b7b34e8e6.php`

---

## Soru 3: Enfeksiyon SonrasÄ± Ä°lk KÃ¼tÃ¼phane Talebi

> **Soru:** Identifying the initial actions of the malware post-infection can provide insights into its primary objectives. What is the first library that the malware requests post-infection?

### Analitik YaklaÅŸÄ±m

Bu sorudaki kilit ifade **"post-infection"** (enfeksiyon sonrasÄ±). Bu, exploit'in baÅŸarÄ±lÄ± olduÄŸunu ve zararlÄ± yazÄ±lÄ±mÄ±n artÄ±k sistemde Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± varsaymamÄ±z gerektiÄŸi anlamÄ±na geliyor. Bu noktadan sonra, zararlÄ±nÄ±n *kendi amacÄ±nÄ± gerÃ§ekleÅŸtirmek iÃ§in* talep ettiÄŸi ilk kÃ¼tÃ¼phaneyi bulmalÄ±yÄ±z.

### KanÄ±tlarÄ± Ä°nceleme

VirusTotal analizinde, zararlÄ±nÄ±n enfeksiyon sonrasÄ± talep ettiÄŸi ilk kÃ¼tÃ¼phane, tarayÄ±cÄ± veritabanlarÄ±na eriÅŸim iÃ§in gerekli olan SQLite kÃ¼tÃ¼phanesidir.

![CyberDefenders platform sorularÄ±](assets/Screenshot%202025-08-21%20at%2022.55.09.png)

GÃ¶rselde, 3. sorunun cevabÄ± olarak **"sqlite3.dll"** kÃ¼tÃ¼phanesi verilmiÅŸtir. Bu kÃ¼tÃ¼phane, zararlÄ±nÄ±n tarayÄ±cÄ± veritabanlarÄ±na eriÅŸerek parola ve diÄŸer kimlik bilgilerini Ã§almak iÃ§in kullandÄ±ÄŸÄ± SQLite veritabanÄ± kÃ¼tÃ¼phanesidir.

**âœ… Cevap:** `sqlite3.dll`

---

## Soru 4: RC4 Åifreleme AnahtarÄ±

> **Soru:** By examining the provided Any.run report, what RC4 key is used by the malware to decrypt its base64-encoded string?

### Analitik YaklaÅŸÄ±m

ZararlÄ± yazÄ±lÄ±mlar, C2 adresleri veya komutlar gibi hassas bilgileri genellikle ÅŸifrelenmiÅŸ olarak saklarlar. Bu bilgileri kullanacaklarÄ± zaman, bellekte bu ÅŸifreyi Ã§Ã¶zmeleri gerekir. Any.run gibi geliÅŸmiÅŸ sandbox'lar, bu tÃ¼r kriptografik aktiviteleri ve bellekte kullanÄ±lan anahtarlarÄ± otomatik olarak tespit edebilir.

### KanÄ±tlarÄ± Ä°nceleme

Any.run raporunun en gÃ¼Ã§lÃ¼ Ã¶zelliklerinden biri olan **"Malware configuration"** bÃ¶lÃ¼mÃ¼, bu tÃ¼r bilgileri bizim iÃ§in Ã¶zetler. Bu bÃ¶lÃ¼m, Any.run'Ä±n analiz sÄ±rasÄ±nda bellekten otomatik olarak Ã§Ä±kardÄ±ÄŸÄ± yapÄ±landÄ±rma verilerini gÃ¶sterir.

![Malware configuration Ã¶zetini gÃ¶steren gÃ¶rsel](assets/Screenshot%202025-08-21%20at%2023.00.29.png)

GÃ¶rselde de gÃ¶rÃ¼ldÃ¼ÄŸÃ¼ gibi, Any.run "Keys" baÅŸlÄ±ÄŸÄ± altÄ±nda "RC4" iÃ§in kullanÄ±lan anahtarÄ± net bir ÅŸekilde yakalamÄ±ÅŸ ve bize sunmuÅŸtur.

**âœ… Cevap:** `5329514621441247975720749009`

---

## Soru 5: Parola Ã‡alma Ä°Ã§in KullanÄ±lan MITRE ATT&CK TekniÄŸi

> **Soru:** By examining the MITRE ATT&CK techniques displayed in the Any.run sandbox report, identify the main MITRE technique (not sub-techniques) the malware uses to steal the user's password.

### Analitik YaklaÅŸÄ±m

MITRE ATT&CK, siber saldÄ±rÄ± tekniklerini standartlaÅŸtÄ±ran bir bilgi bankasÄ±dÄ±r. Any.run, zararlÄ±nÄ±n davranÄ±ÅŸlarÄ±nÄ± otomatik olarak bu Ã§erÃ§eveyle eÅŸleÅŸtirir. Parola Ã§alma, **"Credential Access"** (Kimlik Bilgisi EriÅŸimi) taktiÄŸi altÄ±na girer. Bu analizi yapmak iÃ§in Any.run'Ä±n Processes Graph bÃ¶lÃ¼mÃ¼nÃ¼ kullanarak sÃ¼reÃ§ detaylarÄ±nÄ± incelemek gerekir.

### KanÄ±tlarÄ± Ä°nceleme

Any.run'Ä±n **Processes Graph** bÃ¶lÃ¼mÃ¼nde, `VPN.exe` sÃ¼recine tÄ±kladÄ±ÄŸÄ±mÄ±zda aÃ§Ä±lan **Process Details** penceresi bize MITRE ATT&CK tekniklerini gÃ¶stermektedir.

![Any.run Process Details ve MITRE teknikleri](assets/Screenshot%202025-08-22%20at%2001.53.05.png)

GÃ¶rselde, malware'in davranÄ±ÅŸlarÄ±nÄ±n MITRE ATT&CK ID'leri ile etiketlendiÄŸini gÃ¶rÃ¼yoruz:
- **T1555.003: Credentials from Web Browsers** - Bu, zararlÄ±nÄ±n web tarayÄ±cÄ±larÄ±ndan kimlik bilgisi Ã§aldÄ±ÄŸÄ±nÄ± gÃ¶steren *alt tekniktir*
- **T1552.001: Credentials In Files** - Dosyalardaki kimlik bilgilerine eriÅŸtiÄŸini gÃ¶sterir

Soru bizden **ana tekniÄŸi** (not sub-techniques) istediÄŸi iÃ§in, `T1555.003`'Ã¼n ait olduÄŸu ana kategoriye bakmalÄ±yÄ±z. `.003` kÄ±smÄ± alt-teknik olduÄŸunu gÃ¶sterir, ana teknik ise **T1555**'tir.

**âœ… Cevap:** `T1555: Credentials from Password Stores`

---

## Soru 6: Silinmesi Hedeflenen DLL'lerin Dizini

> **Soru:** By examining the child processes displayed in the Any.run sandbox report, which directory does the malware target for the deletion of all DLL files?

### Analitik YaklaÅŸÄ±m

ZararlÄ± yazÄ±lÄ±mlar genellikle iÅŸleri bittikten sonra arkalarÄ±nda iz bÄ±rakmamak iÃ§in kendilerini veya kullandÄ±klarÄ± bileÅŸenleri silerler. Bu eylem, genellikle Windows'un meÅŸru bir aracÄ± olan Komut Ä°stemi (`cmd.exe`) kullanÄ±larak yapÄ±lÄ±r. Any.run'Ä±n **"Behavior activities"** bÃ¶lÃ¼mÃ¼, bu tÃ¼r komutlarÄ± tÃ¼m detaylarÄ±yla yakalar.

### KanÄ±tlarÄ± Ä°nceleme

Any.run'Ä±n **Behavior activities** bÃ¶lÃ¼mÃ¼nde, `VPN.exe` sÃ¼recinin davranÄ±ÅŸ aktivitelerini incelediÄŸimizde, kendini silmek iÃ§in bir `cmd.exe` sÃ¼reci baÅŸlattÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼yoruz. Bu sÃ¼recin komut satÄ±rÄ± (Cmdline) bize tÃ¼m hikayeyi anlatÄ±yor.

![Behavior activities ve cmd.exe komutunu gÃ¶steren gÃ¶rsel](assets/Screenshot%202025-08-22%20at%2002.01.07.png)

GÃ¶rselde, **Behavior activities (PID: 3484) VPN.exe** bÃ¶lÃ¼mÃ¼nde cmd.exe'nin Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ± komut satÄ±rÄ± ÅŸu ÅŸekildedir:
`"C:\Windows\system32\cmd.exe" /c timeout /t 5 & del /f /q "C:\Users\admin\AppData\Local\Temp\VPN.exe" & del "C:\ProgramData\*.dll"" & exit`

Bu komutun son kÄ±smÄ± olan `del "C:\ProgramData\*.dll"`, zararlÄ±nÄ±n `C:\ProgramData` dizini iÃ§indeki (`*` joker karakteri sayesinde) **tÃ¼m `.dll` uzantÄ±lÄ± dosyalarÄ±** silmek iÃ§in hedeflediÄŸini aÃ§Ä±kÃ§a gÃ¶stermektedir.

**âœ… Cevap:** `C:\ProgramData`

---

## Soru 7: Self-Delete SÃ¼resi

> **Soru:** Understanding the malware's behavior post-data exfiltration can give insights into its evasion techniques. By analyzing the child processes, after successfully exfiltrating the user's data, how many seconds does it take for the malware to self-delete?

### Analitik YaklaÅŸÄ±m

ZararlÄ± yazÄ±lÄ±mlar, veri Ã§alma iÅŸlemi tamamlandÄ±ktan sonra genellikle belirli bir sÃ¼re bekleyerek kendilerini silerler. Bu sÃ¼re, saldÄ±rganÄ±n veri transferinin tamamlandÄ±ÄŸÄ±ndan emin olmak ve aynÄ± zamanda tespit edilme riskini minimize etmek iÃ§in stratejik olarak belirlenir.

### KanÄ±tlarÄ± Ä°nceleme

7. sorunun cevabÄ± da 6. sorudaki gÃ¶rsele bakarsanÄ±z bulunmaktadÄ±r. Any.run'Ä±n **Behavior activities** bÃ¶lÃ¼mÃ¼nde, `VPN.exe` sÃ¼recinin cmd.exe komut satÄ±rÄ±nda ÅŸu komut gÃ¶rÃ¼lmektedir:

`"C:\Windows\system32\cmd.exe" /c timeout /t 5 & del /f /q "C:\Users\admin\AppData\Local\Temp\VPN.exe" & del "C:\ProgramData\*.dll"" & exit`

Bu komuttaki **`timeout /t 5`** kÄ±smÄ±, zararlÄ±nÄ±n veri Ã§alma iÅŸlemi tamamlandÄ±ktan sonra **5 saniye bekleyerek** kendini silmek iÃ§in stratejik bir gecikme uyguladÄ±ÄŸÄ±nÄ± gÃ¶sterir. Bu sÃ¼re, saldÄ±rganÄ±n veri transferinin tamamlandÄ±ÄŸÄ±ndan emin olmak ve aynÄ± zamanda tespit edilme riskini minimize etmek iÃ§in belirlenmiÅŸtir.

**âœ… Cevap:** `5 saniye`

---

## SonuÃ§ ve Ã–ÄŸrenilenler

Tek bir MD5 hash'inden yola Ã§Ä±karak, `cve-2016-0101` zafiyetini sÃ¶mÃ¼ren, `Stealc/Oski` ailesinden bir bilgi hÄ±rsÄ±zÄ±yla karÅŸÄ± karÅŸÄ±ya olduÄŸumuzu anladÄ±k. Bu zararlÄ± yazÄ±lÄ±m:

1. **2022-09-28 17:40'ta oluÅŸturuldu** - SaldÄ±rganÄ±n faaliyet zamanlamasÄ±
2. **C2 sunucusuna baÄŸlandÄ±** - `171.22.28.221` adresindeki PHP endpoint'ine
3. **sqlite3.dll kÃ¼tÃ¼phanesini indirdi** - TarayÄ±cÄ± veritabanlarÄ±na eriÅŸim iÃ§in
4. **RC4 ÅŸifreleme kullandÄ±** - `5329514621441247975720749009` anahtarÄ± ile
5. **T1555 MITRE tekniÄŸini uyguladÄ±** - Parola depolarÄ±ndan kimlik bilgisi Ã§alma
6. **C:\ProgramData dizinindeki DLL'leri hedef aldÄ±** - Ä°z bÄ±rakmamak iÃ§in
7. **5 saniye bekleyerek kendini sildi** - Veri transferi tamamlandÄ±ktan sonra

Bu vaka, "easy" olarak etiketlense de, siber gÃ¼venlik analizinin ne kadar katmanlÄ± ve detaylÄ± olduÄŸunu gÃ¶steren harika bir Ã¶rnektir. VirusTotal gibi triyaj araÃ§larÄ± ile Any.run gibi derinlemesine dinamik analiz platformlarÄ±nÄ± bir arada kullanmak, bir saldÄ±rÄ±nÄ±n tÃ¼m hikayesini ortaya Ã§Ä±karmak iÃ§in ne kadar gÃ¼Ã§lÃ¼ bir kombinasyon olduÄŸunu kanÄ±tlamÄ±ÅŸtÄ±r.

---

## ğŸ“š KullanÄ±lan AraÃ§lar

- **VirusTotal** - Dosya analizi ve tehdit istihbaratÄ±
- **Any.run** - Dinamik malware analizi ve sandbox
- **CyberDefenders** - EÄŸitim platformu

## ğŸ” Anahtar Kavramlar

- **IOC (Indicator of Compromise)** - Tehdit gÃ¶stergeleri
- **C2 (Command & Control)** - Komuta ve kontrol sunucularÄ±
- **MITRE ATT&CK** - Siber saldÄ±rÄ± teknikleri Ã§erÃ§evesi
- **Stealc/Oski** - Bilgi hÄ±rsÄ±zÄ± malware ailesi
- **RC4 Åifreleme** - Simetrik ÅŸifreleme algoritmasÄ±
- **SQLite** - Hafif veritabanÄ± sistemi

---

*Bu yazÄ±, siber gÃ¼venlik eÄŸitimi amaÃ§lÄ± hazÄ±rlanmÄ±ÅŸtÄ±r. GerÃ§ek vakalarda benzer teknikler kullanÄ±lsa da, her analiz kendine Ã¶zgÃ¼ detaylar iÃ§erir.*